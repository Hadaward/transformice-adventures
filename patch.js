"use strict";{let e={version:1.2,changelog:["Added command <</langue [code]>>","Press <<F>> to open emoji roulette","Added language selection menu to login screen"]};document.head.querySelector("style").textContent+=".I_BoutonEtat .croix-active {position: relative;width:1em;height:1em;min-width:1em;min-height:1em;background-color: #281b12;border-radius: 0.2em;box-shadow: inset 1px 1px 1px #000000CC, inset -1px -1px 1px #927A5A;align-self: center;}.I_BoutonEtat .croix-active::after{position:absolute;content:'\\274c';font-size: 0.7em;margin-left:0.10em;color:#7BBD40;font-weight: bold;}";let t={find(e,t){let n=t[e.indexOf("./Module801")],i=t[e.indexOf("./reseau/ProtoM801")],o=t[e.indexOf(e.find(e=>e.endsWith("InterfaceTalents")))],s=t[e.indexOf(e.find(e=>e.endsWith("I_BoutonEtat")))],l=t[e.indexOf(e.find(e=>e.endsWith("Trad801")))],r=t[e.indexOf(e.find(e=>e.endsWith("InterfaceLoginADV")))],u=t[e.indexOf(e.find(e=>e.endsWith("Communaute")))];if(r&&void 0!==r.default&&null===a.loginAdv){a.loginAdv=r.default;let c=a.loginAdv.afficher.bind(a.loginAdv);a.loginAdv.afficher=function(...e){c(...e),e[0]&&a.onLoginScreen()}}u&&void 0!==u.default&&null===a.communaute&&(a.communaute=u.default),l&&void 0!==l.default&&null===a.trad801&&(a.trad801=l.default),n&&i&&this.fixChat(n.default,i.default),o&&this.fixInterfaceTalents(o.default),s&&this.fixCheckBoxes(s.I_BoutonEtat)},fixChat(e,t){t.ajouterPaquet=function(e,t,n){if(1542!=e||!this.indexPaquetLecture[e]){if(void 0===n&&(n=!1),!n&&this.indexPaquetLecture[e])throw Error("Impossible d'avoir plusieurs paquets avec le m\xeame identifiant : 0x"+e.toString(16)+" ("+(e>>8)+", "+(255&e)+")");this.indexPaquetLecture[e]=t}},t.ajouterPaquet(t.fusionCode(6,6),function(t){var n=t.lChaine(),a=t.lChaine();a=a.replace(/&lt;/g,"<"),e.instance.messageChat(a,n)})},fixInterfaceTalents(e){let t=e.afficher.bind(e);e.afficher=function(n){t(n),e.instance.conteneurListeArbres.defHauteur(320)}},fixCheckBoxes(e){e.prototype.cocher=function(e,t){return void 0===t&&(t=!1),this.estCoche=e,this.croix.parentElement||this.fondCroix.appendChild(this.croix),e?this.croix.classList.add("croix-active"):this.croix.classList.remove("croix-active"),t&&this.fonctionClique&&this.fonctionClique(this.estCoche),this}}},n={parent:null,elements:{patchChangelog:{container:null,icon:null},languageMenu:{icon:null,container:null,isMouseOut:{icon:!0,container:!0}}},createPatchChangelog(){if(null!==this.elements.patchChangelog.icon)return;this.elements.patchChangelog.container=document.createElement("div"),this.elements.patchChangelog.container.className="I_Conteneur fond I_Fenetre",this.elements.patchChangelog.container.style="user-select: auto; pointer-events: auto; display: none; align-content: flex-start; flex-flow: column nowrap; align-items: center; min-height: 40px; position: absolute; top: 1%; margin-left: 2.5em;";let t=document.createElement("span");t.className="titre",t.style="white-space: nowrap; user-select: none; pointer-events: none;",t.textContent=`Patch v${e.version}`;let n=document.createElement("div");n.className="cadre",n.style="user-select: none; pointer-events: none;";let a=[];for(let i of e.changelog){let o=document.createElement("span");o.className="I_Texte",o.style="user-select: auto; pointer-events: auto; display: flex; flex-shrink: 0; cursor: pointer; width: 100%; margin: 0.2em;white-space: pre;",o.innerHTML=`<B>-</B> ${i.replace(/\<\</g,'<span style="background-color:rgba(97, 68, 47, 0.8);white-space: pre;border-radius: 4.3px">').replace(/\>\>/g,"</span>")}`,a.push(o)}this.elements.patchChangelog.container.append(t,n,...a),this.elements.patchChangelog.icon=document.createElement("img"),this.elements.patchChangelog.icon.className="I_Image",this.elements.patchChangelog.icon.src="http://data.atelier801.com/tfmadv/interface/metiers/icone-metier-3.png",this.elements.patchChangelog.icon.style="user-select: none; pointer-events: auto; background-color: transparent; width: 32px; height: 32px; position: absolute; top: 0.5em; left: 3em; cursor: pointer; z-index: 0;",this.elements.patchChangelog.icon.onmouseover=()=>{this.elements.patchChangelog.container.style.display="block"},this.elements.patchChangelog.container.onmouseleave=()=>{this.elements.patchChangelog.container.style.display="none"}},createLanguageMenu(){if(null!==this.elements.languageMenu.icon)return;this.elements.languageMenu.icon=document.createElement("img"),this.elements.languageMenu.icon.className="I_Image",this.elements.languageMenu.icon.src=`https://data.atelier801.com/tfmadv/interface/drapeaux/${a.trad801.langueEnCours.code.toUpperCase()}.png`,this.elements.languageMenu.icon.style="user-select: none; pointer-events: auto; background-color: transparent; width: 130px; height: 100px; position: absolute; top: 0.5em; right: 0.5em; cursor: pointer; z-index: 0;",this.elements.languageMenu.container=document.createElement("div"),this.elements.languageMenu.container.className="I_Conteneur fond I_Fenetre",this.elements.languageMenu.container.style="user-select: auto; pointer-events: auto; display: none; align-content: flex-start; flex-flow: column nowrap; align-items: center; min-height: 40px; max-height: 300px; width: 300px; position: absolute; top: 12.5%; right: 0.5em;";let e=document.createElement("span");e.className="titre",e.style="white-space: nowrap; user-select: none; pointer-events: none;",e.textContent=`${a.trad801.trad("$text.langue")}`;let t=document.createElement("div");t.className="cadre",t.style="user-select: none; pointer-events: none;";let n=document.createElement("div");n.style="min-height: 40px; max-height: 300px; width: 300px; overflow-y: auto",this.elements.languageMenu.container.append(e,t,n);let i=[];for(let o of a.communaute.listeCommunautes){if(i.includes(o.nomLangue))continue;i.push(o.nomLangue);let s=document.createElement("img");s.className="I_Image",s.style="user-select: auto; float: left; pointer-events: auto; display: flex; flex-shrink: 0; cursor: pointer; width: 100%; margin: 0.2em;white-space: pre; width: 80px; height: 50px",s.src=`https://data.atelier801.com/tfmadv/interface/drapeaux/${o.identifiant.toUpperCase()}.png`,s.onclick=()=>{a.changeGameLanguage(o.identifiant,t=>{t?(this.elements.languageMenu.icon.src=`https://data.atelier801.com/tfmadv/interface/drapeaux/${a.trad801.langueEnCours.code.toUpperCase()}.png`,e.textContent=`${a.trad801.trad("$text.langue")}`):n.removeChild(s)})},n.append(s)}this.elements.languageMenu.container.onmouseover=()=>{this.elements.languageMenu.isMouseOut.container=!1},this.elements.languageMenu.container.onmouseleave=()=>{this.elements.languageMenu.isMouseOut.container=!0},this.elements.languageMenu.icon.onmouseover=()=>{this.elements.languageMenu.isMouseOut.icon=!1},this.elements.languageMenu.icon.onmouseleave=()=>{this.elements.languageMenu.isMouseOut.icon=!0},this.parent.onclick=()=>{this.elements.languageMenu.isMouseOut.container&&this.elements.languageMenu.isMouseOut.icon&&(this.elements.languageMenu.container.style.display="none")},this.elements.languageMenu.icon.onclick=()=>{this.elements.languageMenu.container.style.display="flex"}},append(){this.createPatchChangelog(),this.createLanguageMenu(),this.parent.append(this.elements.patchChangelog.container,this.elements.patchChangelog.icon),this.parent.append(this.elements.languageMenu.icon,this.elements.languageMenu.container)},remove(){this.parent.removeChild(this.elements.patchChangelog.container),this.parent.removeChild(this.elements.patchChangelog.icon),this.parent.removeChild(this.elements.languageMenu.icon)}},a={trad801:null,loginAdv:null,communaute:null,onLoginScreen(){n.parent=document.body.querySelector("div"),n.append()},changeGameLanguage(e,t){try{this.trad801.chargerFichierLangue(e,"tfmadv",()=>{if(0===Object.keys(this.trad801.indexLangue[e].traductions).length){t&&t(!1);return}for(let n of(this.trad801.selectionnerLangue(e),document.querySelectorAll("*[data-trad]")))this.trad801.definirTraduction(n,n.dataset.trad);t&&t(!0)})}catch{t&&t(!1)}},registerCommands(e){e.default.instance.chat.ajouterCommande("langue",t=>{this.changeGameLanguage(t.join(""),t=>{e.default.instance.chat.ajouterMessage(`${this.trad801.trad("$text.langue")}: ${this.communaute.recupParIdentifiant(this.trad801.langueEnCours.code).nomLangue}`)})})},updateTFMAdventure(e){e.default.DEBUG=!0;let t=e.default.prototype.authentification.bind(e.default.instance);e.default.prototype.authentification=(...a)=>{t(...a),n.remove(),this.registerCommands(e)}}},i=define;window.define=function(e,n){return i(e,function(...a){t.find(e,a),n(...a)})};let o=require;window.require=function(e,t){return o(e,function(...n){t(...n),"dist/Transformice-adventure-client/src/_tfmAdventure/TFMAdventure"===e[0]&&a.updateTFMAdventure(n[0])})}}
